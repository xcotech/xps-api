from django.core.management.base import BaseCommand
from django.utils.text import slugify
from django.contrib.auth import get_user_model


class Command(BaseCommand):
    help = 'usage: python manage.py activity_events_ingest'

    def add_arguments(self, parser):
        parser.add_argument('act_id', type=int)

    def handle(self, *args, **options):
        from apps.tracking.utils import rebuild_activity_events
        from apps.tracking.models import Activity, ActivityData

        act_id = options['act_id']
        if not act_id:
            return
            
        
        algo_output = {"1965": [{"crossing_accelerations": [10.216131, 8.337129, 4.48763, 4.314475, 3.805708, 2.702882, 2.109124, 1.430007, 3.324643, 3.727896, 2.60026, 1.618299, 0.828641, 1.296235, 1.189856, 1.417392, 1.587524, 1.806199, 0.880677, 3.309258, 1.609096, 0.619518, 2.115884, 3.17678, 2.61518, 1.278422, 1.075932, 0.445532, 0.487494, 1.253031, 1.330104, 0.287569, 0.99501, 0.998746, 0.408997, 1.669759, 0.842559, 1.096442, 0.538344, 0.653779, 0.85527, 0.535198, 0.442585, 0.62189, 0.711724, 1.044133, 0.689418, 0.911207, 0.498523, 1.472886, 0.90052, 0.850722, 0.921939, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "crossing_times": [1.568135, 1.774813, 1.965557, 2.12473, 2.274535, 2.419063, 2.558913, 2.694986, 2.81378, 2.931199, 3.049376, 3.167521, 3.286749, 3.400642, 3.515038, 3.626596, 3.733306, 3.838237, 3.944351, 4.038628, 4.153167, 4.254632, 4.349387, 4.442227, 4.53847, 4.63755, 4.733911, 4.834758, 4.93553, 5.040596, 5.1462, 5.248384, 5.349061, 5.450306, 5.556695, 5.656663, 5.760993, 5.859416, 5.963998, 6.065619, 6.164398, 6.265348, 6.364749, 6.467144, 6.563886, 6.661039, 6.75884, 6.854981, 6.956964, 7.050775, 7.15233, 7.254884, 7.357094, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "crossing_velocities": [4.559221, 5.80253, 5.970659, 6.678859, 7.038208, 7.230719, 7.339005, 7.541262, 8.374403, 8.760927, 8.799976, 8.716839, 8.652102, 8.89972, 8.975086, 9.051718, 9.344965, 9.512205, 9.42722, 9.97084, 9.283499, 9.634192, 10.269817, 10.713413, 10.695922, 10.485766, 10.559383, 10.290847, 10.139977, 9.750216, 9.685508, 9.765456, 9.94749, 10.028637, 9.894152, 10.226337, 9.99722, 10.188819, 9.976221, 10.065616, 10.060659, 9.930099, 9.900263, 9.797202, 10.190415, 10.316812, 10.293685, 10.411243, 10.211593, 10.660254, 10.357411, 10.031844, 9.895679, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "end_pos_time": 7.050775, "rec_ID": 0, "recording_end": 8.06, "recording_start": -0.01, "sprint_length": 50.0, "start_distance": 100.0, "start_pos": [0.318445, 4.705043, 0.251062 ], "start_pos_time": 0.99, "step_distance": [0.040374, 0.466522, 1.873432, 3.153773, 4.582681, 6.150019, 7.422883, 9.052091, 11.178142, 12.944704, 14.856859, 16.966192, 19.053249, 21.344124, 23.66041, 26.126423, 28.655174, 30.626535, 33.009335, 35.12978, 37.494579, 39.634056, 42.154953, 44.336487, 46.801765, 49.122784, 51.370514, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_duration": [0.22, 0.26, 0.2, 0.29, 0.27, 0.2, 0.1, 0.1, 0.21, 0.1, 0.1, 0.1, 0.08, 0.1, 0.19, 0.08, 0.09, 0.09, 0.19, 0.09, 0.18, 0.09, 0.19, 0.14, 0.18, 0.14, 0.12, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_gyro_slopes": [666.0, -666.0, 666.0, -666.0, 666.0, -11522.827148, 613.911926, -2701.89917, 1455.942749, -666.0, 9427.566406, -1953.452026, 4082.107422, -666.0, 8300.730469, -666.0, 7188.022949, -1430.130005, 9501.211914, -666.0, 11757.932617, -666.0, 10791.146484, -7910.428711, 14083.208008, -4563.57666, 4741.414551, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_time": [1.22, 1.45, 1.75, 1.99, 2.21, 2.44, 2.62, 2.82, 3.07, 3.28, 3.5, 3.73, 3.95, 4.19, 4.41, 4.65, 4.9, 5.11, 5.35, 5.57, 5.81, 6.03, 6.28, 6.5, 6.74, 6.97, 7.19, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "tag_ID": 75, "was_salvaged": 0 } ], "1966": [{"crossing_accelerations": [9.517745, 8.456812, 4.137532, 3.831816, 4.321845, 3.281476, 2.413099, 1.382325, 2.400418, 3.823056, 2.778082, 1.88835, 1.105684, 1.379001, 0.84413, 1.123919, 1.171025, 1.831823, 1.289319, 0.794841, 0.552567, 0.887203, 2.333341, 3.060422, 2.2461, 0.741383, 0.547936, 0.446657, 0.246581, 0.551797, 2.225112, 2.358725, 1.499212, 1.165123, 0.574374, 1.263872, 0.936287, 0.744957, 0.532421, 0.577526, 1.294326, 0.809381, 0.322475, 0.154802, 0.371617, 0.8761, 0.296405, 0.330239, 0.374007, 0.865252, 0.692461, 0.255333, 0.572763, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "crossing_times": [1.47738, 1.683369, 1.87882, 2.040839, 2.187184, 2.329165, 2.467061, 2.60366, 2.727325, 2.841466, 2.960224, 3.076765, 3.192625, 3.304251, 3.419236, 3.526833, 3.635615, 3.738517, 3.845156, 3.951215, 4.059574, 4.160156, 4.256505, 4.350551, 4.448712, 4.549738, 4.64686, 4.747251, 4.845438, 4.947261, 5.048466, 5.144516, 5.241861, 5.338454, 5.436838, 5.531569, 5.631935, 5.729595, 5.826638, 5.924578, 6.017401, 6.114538, 6.210252, 6.308253, 6.404596, 6.499311, 6.597704, 6.694444, 6.791254, 6.885638, 6.982892, 7.081318, 7.174449, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "crossing_velocities": [4.385047, 5.822094, 5.730874, 6.519117, 7.099349, 7.361609, 7.470234, 7.558877, 8.109491, 8.809875, 8.811069, 8.805539, 8.808048, 9.019591, 8.893226, 9.211874, 9.271714, 9.662581, 9.608271, 9.560857, 9.343917, 9.77726, 10.268416, 10.693563, 10.555818, 10.257049, 10.342583, 10.140546, 10.187263, 9.937034, 10.007339, 10.28381, 10.373878, 10.437595, 10.385388, 10.645328, 10.277666, 10.261292, 10.279521, 10.327404, 10.641239, 10.491128, 10.524933, 10.386259, 10.490686, 10.603441, 10.423352, 10.424309, 10.468043, 10.70507, 10.562925, 10.357914, 10.630786, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "end_pos_time": 6.885638, "rec_ID": 0, "recording_end": 7.89, "recording_start": -0.01, "sprint_length": 50.0, "start_distance": 100.0, "start_pos": [-0.527654, 4.751222, 0.753967 ], "start_pos_time": 0.99, "step_distance": [0.062095, 0.48221, 1.621805, 2.808726, 4.552052, 5.718065, 7.505796, 9.457836, 11.347569, 13.064962, 15.276258, 17.230854, 19.223183, 21.567327, 23.776432, 26.201401, 28.731256, 30.704596, 33.289787, 35.335079, 37.791664, 39.958645, 42.459297, 44.743809, 47.334221, 49.501617, 51.99118, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_duration": [0.31, 0.19, 0.15, 0.14, 0.27, 0.14, 0.12, 0.14, 0.14, 0.09, 0.11, 0.13, 0.08, 0.09, 0.08, 0.13, 0.14, 0.13, 0.2, 0.17, 0.17, 0.09, 0.19, 0.09, 0.2, 0.09, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_gyro_slopes": [-666.0, 666.0, -576.171875, 406.010925, -9268.788086, 666.0, -591.53241, 16417.693359, -666.0, 914.019653, -666.0, 4162.76123, -666.0, 666.0, -666.0, 4445.68457, -12743.37793, 1326.751709, -2371.477295, 987.930298, -666.0, 4056.149414, -666.0, 666.0, -666.0, 1558.866943, -666.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_time": [1.14, 1.36, 1.61, 1.84, 2.12, 2.29, 2.54, 2.78, 3.0, 3.2, 3.45, 3.66, 3.87, 4.12, 4.33, 4.57, 4.82, 5.02, 5.27, 5.47, 5.71, 5.92, 6.16, 6.38, 6.63, 6.84, 7.08, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "tag_ID": 75, "was_salvaged": 0 } ], "1967": [{"crossing_accelerations": [5.226564, 6.526032, 6.282251, 6.512425, 7.500941, 6.553948, 5.526726, 4.469995, 3.509767, 2.897259, 2.622532, 2.420137, 2.263367, 2.188778, 1.989936, 1.921982, 1.835254, 1.738809, 1.639905, 1.34727, 1.090003, 0.879027, 0.897702, 0.962528, 1.052599, 1.042941, 1.010767, 1.033567, 1.050117, 0.960119, 0.87255, 0.876648, 0.913343, 1.029668, 1.018919, 1.048396, 1.04665, 0.987046, 0.987606, 0.999925, 1.000912, 0.941486, 0.896034, 0.829731, 0.805562, 0.815882, 0.793701, 0.716558, 0.478217, 0.260588, 0.216016, 0.334545, 0.298556, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "crossing_times": [8.463449, 8.665835, 8.897193, 9.815891, 9.953895, 10.091991, 10.229828, 10.364074, 10.49332, 10.624, 10.744617, 10.86183, 10.978831, 11.089837, 11.200202, 11.307647, 11.41464, 11.514931, 11.619041, 11.728224, 11.83605, 11.940535, 12.041729, 12.141571, 12.240373, 12.33984, 12.439198, 12.537265, 12.63508, 12.734141, 12.832468, 12.92968, 13.02676, 13.12172, 13.217453, 13.312287, 13.40643, 13.501505, 13.596704, 13.694016, 13.787137, 13.882017, 13.977096, 14.072509, 14.165552, 14.259797, 14.355304, 14.449286, 14.540648, 14.631698, 14.727368, 14.825356, 14.918983, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "crossing_velocities": [3.941035, 5.578432, 6.240303, 5.985997, 7.261506, 7.885263, 8.175433, 8.350993, 8.358981, 8.491876, 8.683079, 8.876412, 9.050201, 9.259555, 9.370921, 9.543091, 9.681584, 9.813032, 9.893482, 9.853232, 9.82308, 9.837363, 9.952036, 10.09262, 10.216283, 10.266744, 10.312507, 10.381616, 10.432997, 10.421254, 10.427904, 10.461641, 10.509128, 10.61884, 10.660737, 10.739249, 10.799869, 10.817696, 10.84614, 10.82232, 10.886007, 10.874875, 10.86604, 10.829059, 10.880779, 10.891382, 10.865777, 10.817945, 10.749403, 10.718817, 10.691489, 10.665722, 10.651839, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "end_pos_time": 14.631698, "rec_ID": 0, "recording_end": 15.64, "recording_start": 5.12, "sprint_length": 50.0, "start_distance": 100.0, "start_pos": [1.142579, 4.25304, 1.378165 ], "start_pos_time": 6.12, "step_distance": [2.108106, 1.685376, 3.060371, 4.649433, 9.803651, 11.465699, 17.855547, 26.604645, 35.870262, 45.373306, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_duration": [0.41, 0.41, 0.31, 0.31, 0.31, 0.61, 0.31, 0.71, 0.61, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_gyro_slopes": [666.0, -666.0, 666.0, -666.0, 700.683594, -146.789551, 1169.026733, -567.626953, 820.973694, -1218.261719, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_time": [9.2, 9.5, 9.7, 9.9, 10.6, 10.8, 11.5, 12.4, 13.3, 14.2, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "tag_ID": 75, "was_salvaged": 0 } ], "1968": [{"crossing_accelerations": [9.20104, 7.07462, 4.232273, 3.16648, 3.450061, 3.468579, 2.661545, 0.805709, 2.191649, 3.482328, 2.676529, 2.048886, 0.664292, 1.623505, 1.206069, 1.386036, 0.834278, 1.544055, 1.128855, 0.287641, 1.391942, 0.878367, 1.74957, 2.519081, 1.363737, 0.585473, 0.582538, 0.735824, 0.308913, 0.721153, 0.44384, 0.482605, 0.957494, 0.677153, 0.567421, 0.844892, 0.691792, 0.674282, 0.592536, 0.215546, 0.341755, 0.536019, 0.265234, 0.197075, 0.285002, 0.19622, 0.260908, 0.249049, 0.338155, 0.318853, 0.355136, 1.010949, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "crossing_times": [1.567659, 1.786436, 1.97976, 2.150921, 2.302661, 2.444502, 2.583865, 2.728889, 2.855621, 2.97411, 3.095602, 3.213203, 3.333797, 3.443334, 3.558242, 3.667272, 3.780179, 3.885225, 3.994381, 4.105638, 4.224153, 4.329351, 4.432524, 4.532004, 4.638764, 4.740933, 4.843065, 4.948161, 5.048427, 5.153104, 5.254328, 5.353203, 5.449737, 5.550124, 5.645637, 5.74208, 5.845171, 5.944375, 6.044664, 6.142079, 6.241565, 6.343255, 6.440619, 6.54099, 6.638008, 6.738469, 6.837159, 6.935773, 7.036302, 7.132723, 7.233862, 7.336686, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "crossing_velocities": [4.329221, 5.406459, 5.742947, 6.191981, 6.799992, 7.305133, 7.419486, 7.209086, 7.841333, 8.492615, 8.529381, 8.645896, 8.474886, 8.973656, 8.89355, 9.156528, 9.096999, 9.478321, 9.406878, 9.241762, 8.660858, 9.192828, 9.609927, 10.058995, 9.705205, 9.735236, 9.687119, 9.480464, 9.65563, 9.506706, 9.649779, 9.87731, 10.136492, 10.01759, 10.228777, 10.289915, 9.918885, 9.967871, 9.912164, 10.075315, 10.019843, 9.879759, 10.078228, 9.983446, 10.148859, 10.013269, 10.092771, 10.113975, 9.970286, 10.17538, 9.963569, 9.755584, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "end_pos_time": 7.132723, "rec_ID": 0, "recording_end": 8.14, "recording_start": -0.01, "sprint_length": 50.0, "start_distance": 100.0, "start_pos": [0.466897, 4.763343, 1.238587 ], "start_pos_time": 0.99, "step_distance": [0.033343, 0.497502, 1.511679, 2.682345, 4.119993, 5.752095, 7.569257, 9.190952, 11.375186, 13.13896, 15.375544, 17.27269, 19.559202, 21.222782, 23.871317, 25.889095, 28.319668, 30.345345, 32.896183, 35.044628, 37.444672, 39.6623, 42.173046, 44.392147, 46.921925, 49.140186, 51.546864, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_duration": [0.37, 0.2, 0.13, 0.14, 0.12, 0.09, 0.17, 0.14, 0.16, 0.1, 0.11, 0.08, 0.13, 0.13, 0.11, 0.08, 0.14, 0.14, 0.15, 0.08, 0.17, 0.08, 0.18, 0.08, 0.16, 0.09, 0.08, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_gyro_slopes": [666.0, -666.0, 7183.736328, -3315.429688, 9041.137695, -838.851929, 666.0, -666.0, 666.0, -729.370117, 666.0, -1749.020508, 666.0, -2730.990234, 666.0, -666.0, 666.0, -3619.112305, 666.0, -2275.739502, 8504.921875, -164.595108, 6988.437988, -11623.579102, 13224.791992, -16392.212891, 5624.720215, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "step_time": [1.2, 1.45, 1.68, 1.92, 2.17, 2.41, 2.67, 2.88, 3.14, 3.35, 3.6, 3.81, 4.06, 4.25, 4.52, 4.73, 4.98, 5.19, 5.44, 5.65, 5.89, 6.11, 6.36, 6.58, 6.83, 7.05, 7.29, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0 ], "tag_ID": 75, "was_salvaged": 0 } ] }
        
        algo_output.update({
            "131": [{"crossing_accelerations": [6.732283, 4.972181, 2.901092, 2.31337, 3.922087, 3.911705, 1.840837, 0.700187, 2.49802, 5.474392, 2.96783, 1.591227, 0.534955, 0.209589, 0.645263, 2.266931, 1.780921, 1.449459, 0.628473, 0.387768, 0.494561, 1.262808, 1.570828, 3.084208, 2.606539, 0.830518, 0.539187, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "step_time": [1.18, 1.43, 1.71, 1.98, 2.23, 2.48, 2.73, 2.97, 3.22, 3.47, 3.71, 3.95, 4.19, 4.44, 4.68, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "was_salvaged": 0, "step_distance": [0.412738, 1.398649, 2.687614, 4.102799, 5.736201, 7.31535, 9.086717, 11.030328, 12.963892, 14.929405, 16.976583, 18.981737, 21.055248, 23.383879, 25.699076, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "crossing_times": [1.328341, 1.565667, 1.774477, 1.962862, 2.119071, 2.269084, 2.424824, 2.587953, 2.719512, 2.836542, 2.966327, 3.091289, 3.225074, 3.353756, 3.478984, 3.593665, 3.712881, 3.828985, 3.951045, 4.065509, 4.183455, 4.292435, 4.401712, 4.499072, 4.60427, 4.712663, 4.822781, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "recording_end": 5.61, "rec_ID": 0, "end_pos_time": 4.60427, "step_gyro_slopes": [-666.0, 3490.498779, -7729.619141, 5452.524902, -10176.824219, 7917.556641, -6335.754395, 6920.216797, -9373.931641, 4019.343018, -9163.818359, 4454.70166, -13290.775391, 3796.717285, -4778.35498, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "recording_start": -0.01, "step_duration": [0.19, 0.12, 0.12, 0.09, 0.09, 0.11, 0.1, 0.08, 0.1, 0.09, 0.11, 0.08, 0.11, 0.08, 0.12, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "tag_ID": 68, "start_pos_time": 0.99, "start_distance": 100.0, "start_pos": [0.279626, 4.340591, 0.612662], "crossing_velocities": [4.116642, 4.89289, 5.196997, 5.558801, 6.512241, 7.033941, 6.799313, 6.414769, 7.471202, 8.515545, 8.257016, 8.249332, 7.779663, 7.808136, 8.035391, 8.619074, 8.646515, 8.705794, 8.324587, 8.532927, 8.441921, 8.938293, 9.203236, 9.940555, 9.900324, 9.604231, 9.292543, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "sprint_length": 25.0}],
            "132": [{"crossing_accelerations": [6.60436, 5.535757, 3.317801, 2.760316, 4.19731, 3.740436, 1.291642, 0.386494, 3.004206, 4.990849, 2.981532, 1.512446, 0.615327, 0.651944, 0.836889, 2.283994, 1.810552, 0.947797, 0.269772, 1.105228, 0.66535, 0.986549, 1.159735, 2.307969, 2.537131, 0.985816, 0.328475, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "step_time": [1.16, 1.42, 1.77, 1.95, 2.19, 2.44, 2.68, 2.93, 3.17, 3.42, 3.65, 3.9, 4.13, 4.39, 4.63, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "was_salvaged": 0, "step_distance": [0.36398, 1.384674, 3.104274, 4.139833, 5.748232, 7.364082, 9.174562, 11.218779, 13.128198, 15.185894, 17.20768, 19.319517, 21.275616, 23.676514, 25.945778, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "crossing_times": [1.328064, 1.553111, 1.751513, 1.92933, 2.079525, 2.225413, 2.377923, 2.533606, 2.659066, 2.776279, 2.902675, 3.025079, 3.154354, 3.280296, 3.398058, 3.510028, 3.626323, 3.741225, 3.858974, 3.980294, 4.099067, 4.207447, 4.319392, 4.422318, 4.525983, 4.635656, 4.744192, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "recording_end": 5.53, "rec_ID": 0, "end_pos_time": 4.525983, "step_gyro_slopes": [-666.0, 5925.737793, -666.0, 5367.533203, -10373.509766, 5539.754395, -10161.132812, 4266.789551, -13392.486328, 5501.138672, -9578.857422, 2613.270996, -7452.959473, 9800.011719, -5745.849609, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "recording_start": -0.01, "step_duration": [0.17, 0.14, 0.23, 0.1, 0.1, 0.11, 0.1, 0.1, 0.09, 0.15, 0.11, 0.09, 0.11, 0.13, 0.11, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "tag_ID": 68, "start_pos_time": 0.99, "start_distance": 100.0, "start_pos": [1.160193, 4.355935, 1.058762], "crossing_velocities": [4.086235, 5.12009, 5.442249, 5.919553, 6.786097, 7.202863, 6.899167, 6.657448, 7.834612, 8.616783, 8.419451, 8.410043, 7.924849, 7.871146, 8.33611, 8.893711, 8.820621, 8.802455, 8.590714, 8.33706, 8.310349, 8.863248, 9.018358, 9.581917, 9.792974, 9.488008, 9.302693, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "sprint_length": 25.0}],
            "133": [{"crossing_accelerations": [6.890656, 4.632738, 3.058225, 2.470976, 3.160842, 3.863775, 2.279485, 0.233191, 2.572452, 4.867448, 2.414215, 1.01372, 0.433479, 0.27901, 1.500558, 2.316352, 2.013313, 1.015758, 1.128075, 0.592411, 0.313279, 0.313285, 1.614337, 3.021165, 1.935369, 0.861341, 0.749648, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "step_time": [1.16, 1.43, 1.7, 1.97, 2.22, 2.48, 2.72, 2.96, 3.21, 3.44, 3.69, 3.92, 4.15, 4.4, 4.65, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "was_salvaged": 0, "step_distance": [0.343211, 1.372021, 2.596611, 3.991501, 5.567913, 7.25185, 8.940282, 10.867364, 12.795386, 14.62627, 16.807383, 18.708275, 20.703064, 22.953465, 25.326778, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "crossing_times": [1.33361, 1.576322, 1.783957, 1.971218, 2.135397, 2.283705, 2.434521, 2.596147, 2.726085, 2.845587, 2.977278, 3.106069, 3.235813, 3.364161, 3.480361, 3.596621, 3.71031, 3.829259, 3.953766, 4.065215, 4.184694, 4.29966, 4.403813, 4.50617, 4.614188, 4.72159, 4.835452, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "recording_end": 5.62, "rec_ID": 0, "end_pos_time": 4.614188, "step_gyro_slopes": [-666.0, 4297.815918, -10068.181641, 7206.776855, -6997.593262, 5200.678711, -12175.90332, 6415.812012, -17639.693359, 5717.722656, -12092.132812, 18406.525391, -7240.818359, 4578.24707, -7777.862793, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "recording_start": -0.01, "step_duration": [0.19, 0.13, 0.2, 0.1, 0.11, 0.11, 0.1, 0.12, 0.09, 0.11, 0.1, 0.1, 0.11, 0.12, 0.13, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "tag_ID": 68, "start_pos_time": 0.99, "start_distance": 100.0, "start_pos": [1.098402, 4.321198, 1.061909], "crossing_velocities": [4.099006, 4.755345, 5.182759, 5.588628, 6.257865, 6.942645, 6.943376, 6.502111, 7.589377, 8.420033, 8.11634, 7.961021, 7.822174, 7.777305, 8.459759, 8.692427, 8.957629, 8.682026, 8.241782, 8.647105, 8.473225, 8.599798, 9.316952, 9.753077, 9.619074, 9.524554, 9.025944, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "sprint_length": 25.0}],
            "178": [{"crossing_accelerations": [6.890656, 4.632738, 3.058225, 2.470976, 3.160842, 3.863775, 2.279485, 0.233191, 2.572452, 4.867448, 2.414215, 1.01372, 0.433479, 0.27901, 1.500558, 2.316352, 2.013313, 1.015758, 1.128075, 0.592411, 0.313279, 0.313285, 1.614337, 3.021165, 1.935369, 0.861341, 0.749648, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "step_time": [1.16, 1.43, 1.7, 1.97, 2.22, 2.48, 2.72, 2.96, 3.21, 3.44, 3.69, 3.92, 4.15, 4.4, 4.65, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "was_salvaged": 0, "step_distance": [0.343211, 1.372021, 2.596611, 3.991501, 5.567913, 7.25185, 8.940282, 10.867364, 12.795386, 14.62627, 16.807383, 18.708275, 20.703064, 22.953465, 25.326778, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "crossing_times": [1.33361, 1.576322, 1.783957, 1.971218, 2.135397, 2.283705, 2.434521, 2.596147, 2.726085, 2.845587, 2.977278, 3.106069, 3.235813, 3.364161, 3.480361, 3.596621, 3.71031, 3.829259, 3.953766, 4.065215, 4.184694, 4.29966, 4.403813, 4.50617, 4.614188, 4.72159, 4.835452, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "recording_end": 5.62, "rec_ID": 0, "end_pos_time": 4.614188, "step_gyro_slopes": [-666.0, 4297.815918, -10068.181641, 7206.776855, -6997.593262, 5200.678711, -12175.90332, 6415.812012, -17639.693359, 5717.722656, -12092.132812, 18406.525391, -7240.818359, 4578.24707, -7777.862793, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "recording_start": -0.01, "step_duration": [0.19, 0.13, 0.2, 0.1, 0.11, 0.11, 0.1, 0.12, 0.09, 0.11, 0.1, 0.1, 0.11, 0.12, 0.13, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "tag_ID": 68, "start_pos_time": 0.99, "start_distance": 100.0, "start_pos": [1.098402, 4.321198, 1.061909], "crossing_velocities": [4.099006, 4.755345, 5.182759, 5.588628, 6.257865, 6.942645, 6.943376, 6.502111, 7.589377, 8.420033, 8.11634, 7.961021, 7.822174, 7.777305, 8.459759, 8.692427, 8.957629, 8.682026, 8.241782, 8.647105, 8.473225, 8.599798, 9.316952, 9.753077, 9.619074, 9.524554, 9.025944, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0, -1.0], "sprint_length": 25.0}]
        })


        
        events, data_summary = rebuild_activity_events(act_id, algo_output.get(str(act_id))[0])

        if events and data_summary:
            print('------------- events?\n %s' % events)
            print('------------- summary\n %s' % data_summary)
            
            proceed = input('OK to update events for activity %s with this output? (y/n)')
            if proceed.lower() == 'y':
                activity = Activity.objects.get(pk=act_id)
                activity.data_summary = data_summary
                activity.save()
                activity.data.events = events
                activity.data.save()



  
